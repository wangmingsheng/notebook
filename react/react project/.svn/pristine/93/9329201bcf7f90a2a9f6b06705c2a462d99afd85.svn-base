var DataFactory = require('./DataFactory');

function DepartmentData() {}

DepartmentData.prototype =  Object.create(new DataFactory, {
	/// 获取所有部门
	getList: {
		value: function(teamId, callback) {
			var data = Interface.getDepartment();
			if (data) {
				this.list = data;
				var items = {};
				for (var i = 0; i < data.length; i++) {
					items[data[i]._id] = data[i];
				}
				this.source = items;
				return true;
			}

			Forms.get({
				uri: '/teams/' + teamId + '/departments',
				callback: function(e) {
					if (e.code == 200) {
						var data = e.data;
						if (data) {
							this.list = data;
							var items = {};
							for (var i = 0; i < data.length; i++) {
								items[data[i]._id] = data[i];
							}
							this.source = items;
						}
					}

					typeof(callback) == 'function' && callback();
				}.bind(this)
			});
		}
	}
});

DepartmentData.prototype.constructor = DepartmentData;

module.exports = new DepartmentData;