
module.exports = React.createClass({
    oneSelected: function(id){
        for(var i in this.state.select) {
            if(i != id) this.state.select[i] = false;
        }
    },
    rowSelectedEvent: function(id) {
        this.state.select[id] = !this.state.select[id];
        switch(this.props.type) {
            case 'one_select':
                this.oneSelected(id);
                this.props.callBack && this.props.callBack(this.state.select);
                break;
            case 'click':
                this.props.callBack && this.props.callBack(id);
                return false;
                break;
            case 'no':
                return false;
                break;
            default:
                break;
        }
        this.setState(this.state);
    },
    componentWillReceiveProps: function(nProps) {
        if (nProps.search != this.state.key) {
            this.setState({search: nProps.search})
        }
        this.setState({select: nProps.selected});
    },
    shouldComponentUpdate: function(nProps, nState) {
        return this.state != nState;
    },
    getInitialState: function() {
        return {select: this.props.selected || {}, source: this.props.source || [] , search: this.props.search || ''}
    },
    render: function() {
        return <ul className="team_member_list">
            {
                this.state.source.map(function(item , index) {
                    if(this.state.search.length > 0 && item.display_name_pinyin.toLowerCase().indexOf(this.state.search.toLowerCase()) == -1) return null;
                    return <li className={this.state.select[item._id] ? 'check' : null} key={index} onClick={this.rowSelectedEvent.bind(this,item._id)}>
                        <div className="avatar"><img src={item.avatar} alt=""/></div>
                        <div className="member_name"><span>{item.display_name}</span></div>
                    </li>
                }.bind(this))
            }
        </ul>
    }
});
